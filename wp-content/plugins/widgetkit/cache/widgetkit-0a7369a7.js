jQuery(function($){$('select[name="settings[style]"]').bind("change",function(){$("#form").trigger("submit")});$("button.action.add").bind("click",function(){$.post(widgetkitajax+"&task=item_map",{id:$('input[name="id"]').val()},function(data){$(data).appendTo("#items");$("#order").trigger("update")})});if($('input[name="id"]').val()==0){$("button.action.add").trigger("click")}$("#items").delegate(".box","delete",function(e,button){$(this).fadeOut(300,function(){$(this).remove();$("#order").trigger("update")})});$("#items").delegate("input.title","update",function(){var item=$(this).closest(".item");var value=$(this).val()?$(this).val():"untitled";var title=item.find("h3.title");if(item.is(".item:first-child")){title.html(value+'<span class="info">center</span>')}else{title.html(value)}$('#order li[rel="'+item.attr("id")+'"]').html(value)});$("#order").sortable({axis:"y",start:function(event,ui){$("#"+ui.item.attr("rel")).addClass("sortactive")},stop:function(event,ui){setTimeout(function(){$("#"+ui.item.attr("rel")).removeClass("sortactive")},800)},update:function(event,ui){var item=$("#"+ui.item.attr("rel"));var next=ui.item.next();var prev=ui.item.prev();item.find(".html-editor").trigger("editor-action-start");if(next.length){item.insertBefore($("#"+next.attr("rel")))}else{item.insertAfter($("#"+prev.attr("rel")))}item.find(".html-editor").trigger("editor-action-stop");$("#order").trigger("update")}}).bind("update",function(){var $this=$(this);$("li",this).each(function(){if(!$("#"+$(this).attr("rel")).length)$(this).remove()});$("#items > .item").each(function(i){var id=$(this).attr("id");if(!$this.find("[rel='"+id+"']").length){$this.append('<li rel="'+id+'"></li>')}$("input.title",this).trigger("update")})}).trigger("update");var locator=$("#addresslocator"),address=locator.find("input.address"),lat=locator.find("input.lat"),lng=locator.find("input.lng"),map=locator.find("div.map");var gmap=new google.maps.Map(map.get(0),{zoom:4,streetViewControl:false,center:new google.maps.LatLng(-34.397,150.644),mapTypeId:google.maps.MapTypeId.ROADMAP});if(lat.val()!=""&&lng.val()!=""){var initpoint=new google.maps.LatLng(lat.val(),lng.val())}else{var initpoint=new google.maps.LatLng(51.151786,10.415039);lat.val(51.151786);lng.val(10.415039)}gmap.setCenter(initpoint);var marker=new google.maps.Marker({position:initpoint,draggable:true,map:gmap});google.maps.event.addListener(marker,"dragend",function(){lat.val(marker.position.lat());lng.val(marker.position.lng())});$("#items").delegate(".loc-data","click",function(){var $loc=$(this),$spn=$loc.find("span:first"),$lat=$loc.find('input[name$="[lat]"]'),$lng=$loc.find('input[name$="[lng]"]');address.autocomplete({delay:500,minLength:3,source:function(request,response){$.getJSON(widgetkitajax+"&task=locate_map",{address:address.val()},function(data){var ret=response($.map(data.results,function(item){return{label:item.formatted_address,value:item.formatted_address,lat:item.geometry.location.lat,lng:item.geometry.location.lng}}))})},select:function(event,ui){lat.val(ui.item.lat);lng.val(ui.item.lng);var point=new google.maps.LatLng(lat.val(),lng.val());marker.setPosition(point);gmap.setCenter(point)}});address.val("");lat.val($lat.val());lng.val($lng.val());var point=new google.maps.LatLng($lat.val(),$lng.val());marker.setPosition(point);gmap.setCenter(point);locator.find("button").unbind("click").bind("click",function(){$lat.val(lat.val());$lng.val(lng.val());$spn.html("(Lat: "+lat.val()+", Lng: "+lng.val()+")");$.modalwin.close()});$.modalwin(locator)})});
(function($){var Plugin=function(){};var api_loaded=false,api_ready=false,queue_for_init=[];if(window["google"]&&google["maps"]){api_loaded=true;api_ready=true}$.extend(Plugin.prototype,{name:"googlemaps",options:{lat:53.553407,lng:9.992196,marker:true,popup:false,text:"",zoom:13,mapCtrl:1,zoomWhl:true,draggable:true,mapTypeId:"roadmap",typeCtrl:true,directions:true,directionsDestUpdate:true,mainIcon:"red-dot",otherIcon:"blue-dot",iconUrl:document.location.protocol+"//maps.google.com/mapfiles/ms/micons/",clusterMarker:false},markers:[],initialize:function(container,options){var $this=this;this.options.msgFromAddress=$widgetkit.trans.get("FROM_ADDRESS");this.options.msgGetDirections=$widgetkit.trans.get("GET_DIRECTIONS");this.options.msgEmpty=$widgetkit.trans.get("FILL_IN_ADDRESS");this.options.msgNotFound=$widgetkit.trans.get("ADDRESS_NOT_FOUND");this.options.msgAddressNotFound=$widgetkit.trans.get("LOCATION_NOT_FOUND");this.options=$.extend({},this.options,options);this.container=container;api_ready?$this.setupMap():queue_for_init.push(this)},setupMap:function(){var $this=this,options=this.options;this.map=new google.maps.Map(this.container.get(0),{mapTypeId:options.mapTypeId,center:new google.maps.LatLng(options.lat,options.lng),streetViewControl:options.mapCtrl?true:false,navigationControl:options.mapCtrl,scrollwheel:options.zoomWhl?true:false,draggable:options.zoomWhl?true:false,mapTypeControl:options.typeCtrl?true:false,zoomControl:options.mapCtrl?true:false,zoomControlOptions:{style:options.mapCtrl==1?google.maps.ZoomControlStyle.DEFAULT:google.maps.ZoomControlStyle.SMALL}});this.infowindow=new google.maps.InfoWindow;if(options.marker){if(options.popup==0){var point=new google.maps.LatLng(options.lat,options.lng);this.map.setCenter(point);this.map.setZoom(options.zoom)}else{this.addMarkerLatLng(options.lat,options.lng,options.text,true)}}if(options.mapTypeId=="roadmap"){this.map.mapTypeIds=["custom"];this.map.mapTypes.set("custom",new google.maps.StyledMapType([{featureType:"all",elementType:"all",stylers:[{invert_lightness:options["styler_invert_lightness"]},{hue:options["styler_hue"]},{saturation:options["styler_saturation"]},{lightness:options["styler_lightness"]},{gamma:options["styler_gamma"]}]}],{name:"CustomStyle"}));this.map.setMapTypeId("custom")}if(options["adresses"]&&options.adresses.length){for(var index=0;index<options.adresses.length;index++){var adress=options.adresses[index];if(adress["lat"]&&adress["lng"]){this.addMarkerLatLng(adress.lat,adress.lng,adress["popup"],adress["center"],adress["icon"])}}}if(options.directions){this.setupDirections()}if(options.clusterMarker){this.marker_cluster=new MarkerClusterer(this.map,this.markers)}},createMarker:function(position,text,iconimage){var $this=this;var map=this.map;var infowindow=this.infowindow;var markerImage=new google.maps.MarkerImage(this.options.iconUrl+iconimage+".png",new google.maps.Size(32,32),new google.maps.Point(0,0),new google.maps.Point(16,32));var shadow=iconimage.match("pushpin")?this.options.iconUrl+"pushpin_shadow.png":this.options.iconUrl+"msmarker.shadow.png";var shadowImage=new google.maps.MarkerImage(shadow,new google.maps.Size(56,32),new google.maps.Point(0,0),new google.maps.Point(16,32));var marker=new google.maps.Marker({position:position,icon:markerImage,shadow:shadowImage,map:this.map});google.maps.event.addListener(marker,"click",function(){if(text.length){infowindow.setContent(text);infowindow.open(map,marker)}if($this.options.directionsDestUpdate){$this.options.lat=marker.getPosition().lat();$this.options.lng=marker.getPosition().lng()}});this.markers.push(marker);return marker},centerMap:function(lat,lng){var point=new google.maps.LatLng(lat,lng);this.map.setCenter(point);this.map.setZoom(this.options.zoom)},addMarkerLatLng:function(lat,lng,text,center,icon){var icon=icon||this.options.otherIcon;if(center)icon=this.options.mainIcon;var point=new google.maps.LatLng(lat,lng);var marker=this.createMarker(point,text,icon);if(center){this.map.setCenter(point);this.map.setZoom(this.options.zoom)}if(center&&text&&text.length&&this.options.popup==2){this.infowindow.setContent(text);this.infowindow.open(this.map,marker)}},setupDirections:function(){var $this=this;this.directionsService=new google.maps.DirectionsService;this.directionsDisplay=new google.maps.DirectionsRenderer;this.directionsDisplay.setMap(this.map);this.directionsDisplay.setPanel($("<div>").addClass("directions").css("position","relative").insertAfter(this.container).get(0));var p=$("<p>").append('<label for="from-address">'+this.options.msgFromAddress+"</label>").append('<input type="text" name="address" style="margin:0 5px;" />').append('<button type="submit">'+this.options.msgGetDirections+"</button>");$('<form method="get" action="#"></form>').append(p).insertAfter(this.container).bind("submit",function(event){event.preventDefault();event.stopPropagation();$this.setDirections($(this))})},setDirections:function(form){var $this=this;this.container.parent().find("div.alert").remove();var from=form.find('input[name="address"]').val();if(from===""){this.showAlert(this.options.msgEmpty)}else{var request={origin:from,destination:new google.maps.LatLng(this.options.lat,this.options.lng),travelMode:google.maps.DirectionsTravelMode.DRIVING};if("unitSystem"in this.options){request["unitSystem"]=this.options["unitSystem"]}this.directionsService.route(request,function(response,status){if(status==google.maps.DirectionsStatus.OK){$this.directionsDisplay.setDirections(response)}else{$this.showAlert($this.options.msgNotFound)}})}},showAlert:function(msg){$("<div>").addClass("alert").append($("<strong>").text(msg)).insertAfter(this.container)},cmd:function(){var args=arguments;var method=args[0]?args[0]:null;if(this.map[method]){this.map[method].apply(this.map,Array.prototype.slice.call(args,1))}}});$.fn[Plugin.prototype.name]=function(){var args=arguments;var method=args[0]?args[0]:null;return this.each(function(){if(!api_loaded){var script=document.createElement("script");script.type="text/javascript";script.async=1;script.src=location.protocol+"//maps.google.com/maps/api/js?sensor=false&callback=jQuery.fn.googlemaps.ready";document.body.appendChild(script);api_loaded=true}var element=$(this);if(Plugin.prototype[method]&&element.data(Plugin.prototype.name)&&method!="initialize"){element.data(Plugin.prototype.name)[method].apply(element.data(Plugin.prototype.name),Array.prototype.slice.call(args,1))}else if(!method||$.isPlainObject(method)){var plugin=new Plugin;if(Plugin.prototype["initialize"]){plugin.initialize.apply(plugin,$.merge([element],args))}element.data(Plugin.prototype.name,plugin)}else{$.error("Method "+method+" does not exist on jQuery."+Plugin.name)}})};$.fn[Plugin.prototype.name].ready=function(){for(var i=0;i<queue_for_init.length;i++){if(queue_for_init[i]["setupMap"]){queue_for_init[i].setupMap()}}api_ready=true};function MarkerClusterer(map,opt_markers,opt_options){this.extend(MarkerClusterer,google.maps.OverlayView);this.map_=map;this.markers_=[];this.clusters_=[];this.sizes=[53,56,66,78,90];this.styles_=[];this.ready_=false;var options=opt_options||{};this.gridSize_=options["gridSize"]||60;this.minClusterSize_=options["minimumClusterSize"]||2;this.maxZoom_=options["maxZoom"]||null;this.styles_=options["styles"]||[];this.imagePath_=options["imagePath"]||this.MARKER_CLUSTER_IMAGE_PATH_;this.imageExtension_=options["imageExtension"]||this.MARKER_CLUSTER_IMAGE_EXTENSION_;this.zoomOnClick_=true;if(options["zoomOnClick"]!=undefined){this.zoomOnClick_=options["zoomOnClick"]}this.averageCenter_=false;if(options["averageCenter"]!=undefined){this.averageCenter_=options["averageCenter"]}this.setupStyles_();this.setMap(map);this.prevZoom_=this.map_.getZoom();var that=this;google.maps.event.addListener(this.map_,"zoom_changed",function(){var zoom=that.map_.getZoom();if(that.prevZoom_!=zoom){that.prevZoom_=zoom;that.resetViewport()}});google.maps.event.addListener(this.map_,"idle",function(){that.redraw()});if(opt_markers&&opt_markers.length){this.addMarkers(opt_markers,false)}}MarkerClusterer.prototype.MARKER_CLUSTER_IMAGE_PATH_="http://google-maps-utility-library-v3.googlecode.com/svn/trunk/markerclusterer/"+"images/m";MarkerClusterer.prototype.MARKER_CLUSTER_IMAGE_EXTENSION_="png";MarkerClusterer.prototype.extend=function(obj1,obj2){return function(object){for(var property in object.prototype){this.prototype[property]=object.prototype[property]}return this}.apply(obj1,[obj2])};MarkerClusterer.prototype.onAdd=function(){this.setReady_(true)};MarkerClusterer.prototype.draw=function(){};MarkerClusterer.prototype.setupStyles_=function(){if(this.styles_.length){return}for(var i=0,size;size=this.sizes[i];i++){this.styles_.push({url:this.imagePath_+(i+1)+"."+this.imageExtension_,height:size,width:size})}};MarkerClusterer.prototype.fitMapToMarkers=function(){var markers=this.getMarkers();var bounds=new google.maps.LatLngBounds;for(var i=0,marker;marker=markers[i];i++){bounds.extend(marker.getPosition())}this.map_.fitBounds(bounds)};MarkerClusterer.prototype.setStyles=function(styles){this.styles_=styles};MarkerClusterer.prototype.getStyles=function(){return this.styles_};MarkerClusterer.prototype.isZoomOnClick=function(){return this.zoomOnClick_};MarkerClusterer.prototype.isAverageCenter=function(){return this.averageCenter_};MarkerClusterer.prototype.getMarkers=function(){return this.markers_};MarkerClusterer.prototype.getTotalMarkers=function(){return this.markers_.length};MarkerClusterer.prototype.setMaxZoom=function(maxZoom){this.maxZoom_=maxZoom};MarkerClusterer.prototype.getMaxZoom=function(){return this.maxZoom_};MarkerClusterer.prototype.calculator_=function(markers,numStyles){var index=0;var count=markers.length;var dv=count;while(dv!==0){dv=parseInt(dv/10,10);index++}index=Math.min(index,numStyles);return{text:count,index:index}};MarkerClusterer.prototype.setCalculator=function(calculator){this.calculator_=calculator};MarkerClusterer.prototype.getCalculator=function(){return this.calculator_};MarkerClusterer.prototype.addMarkers=function(markers,opt_nodraw){for(var i=0,marker;marker=markers[i];i++){this.pushMarkerTo_(marker)}if(!opt_nodraw){this.redraw()}};MarkerClusterer.prototype.pushMarkerTo_=function(marker){marker.isAdded=false;if(marker["draggable"]){var that=this;google.maps.event.addListener(marker,"dragend",function(){marker.isAdded=false;that.repaint()})}this.markers_.push(marker)};MarkerClusterer.prototype.addMarker=function(marker,opt_nodraw){this.pushMarkerTo_(marker);if(!opt_nodraw){this.redraw()}};MarkerClusterer.prototype.removeMarker_=function(marker){var index=-1;if(this.markers_.indexOf){index=this.markers_.indexOf(marker)}else{for(var i=0,m;m=this.markers_[i];i++){if(m==marker){index=i;break}}}if(index==-1){return false}marker.setMap(null);this.markers_.splice(index,1);return true};MarkerClusterer.prototype.removeMarker=function(marker,opt_nodraw){var removed=this.removeMarker_(marker);if(!opt_nodraw&&removed){this.resetViewport();this.redraw();return true}else{return false}};MarkerClusterer.prototype.removeMarkers=function(markers,opt_nodraw){var removed=false;for(var i=0,marker;marker=markers[i];i++){var r=this.removeMarker_(marker);removed=removed||r}if(!opt_nodraw&&removed){this.resetViewport();this.redraw();return true}};MarkerClusterer.prototype.setReady_=function(ready){if(!this.ready_){this.ready_=ready;this.createClusters_()}};MarkerClusterer.prototype.getTotalClusters=function(){return this.clusters_.length};MarkerClusterer.prototype.getMap=function(){return this.map_};MarkerClusterer.prototype.setMap=function(map){this.map_=map};MarkerClusterer.prototype.getGridSize=function(){return this.gridSize_};MarkerClusterer.prototype.setGridSize=function(size){this.gridSize_=size};MarkerClusterer.prototype.getMinClusterSize=function(){return this.minClusterSize_};MarkerClusterer.prototype.setMinClusterSize=function(size){this.minClusterSize_=size};MarkerClusterer.prototype.getExtendedBounds=function(bounds){var projection=this.getProjection();var tr=new google.maps.LatLng(bounds.getNorthEast().lat(),bounds.getNorthEast().lng());var bl=new google.maps.LatLng(bounds.getSouthWest().lat(),bounds.getSouthWest().lng());var trPix=projection.fromLatLngToDivPixel(tr);trPix.x+=this.gridSize_;trPix.y-=this.gridSize_;var blPix=projection.fromLatLngToDivPixel(bl);blPix.x-=this.gridSize_;blPix.y+=this.gridSize_;var ne=projection.fromDivPixelToLatLng(trPix);var sw=projection.fromDivPixelToLatLng(blPix);bounds.extend(ne);bounds.extend(sw);return bounds};MarkerClusterer.prototype.isMarkerInBounds_=function(marker,bounds){return bounds.contains(marker.getPosition())};MarkerClusterer.prototype.clearMarkers=function(){this.resetViewport(true);this.markers_=[]};MarkerClusterer.prototype.resetViewport=function(opt_hide){for(var i=0,cluster;cluster=this.clusters_[i];i++){cluster.remove()}for(var i=0,marker;marker=this.markers_[i];i++){marker.isAdded=false;if(opt_hide){marker.setMap(null)}}this.clusters_=[]};MarkerClusterer.prototype.repaint=function(){var oldClusters=this.clusters_.slice();this.clusters_.length=0;this.resetViewport();this.redraw();window.setTimeout(function(){for(var i=0,cluster;cluster=oldClusters[i];i++){cluster.remove()}},0)};MarkerClusterer.prototype.redraw=function(){this.createClusters_()};MarkerClusterer.prototype.distanceBetweenPoints_=function(p1,p2){if(!p1||!p2){return 0}var R=6371;var dLat=(p2.lat()-p1.lat())*Math.PI/180;var dLon=(p2.lng()-p1.lng())*Math.PI/180;var a=Math.sin(dLat/2)*Math.sin(dLat/2)+Math.cos(p1.lat()*Math.PI/180)*Math.cos(p2.lat()*Math.PI/180)*Math.sin(dLon/2)*Math.sin(dLon/2);var c=2*Math.atan2(Math.sqrt(a),Math.sqrt(1-a));var d=R*c;return d};MarkerClusterer.prototype.addToClosestCluster_=function(marker){var distance=4e4;var clusterToAddTo=null;var pos=marker.getPosition();for(var i=0,cluster;cluster=this.clusters_[i];i++){var center=cluster.getCenter();if(center){var d=this.distanceBetweenPoints_(center,marker.getPosition());if(d<distance){distance=d;clusterToAddTo=cluster}}}if(clusterToAddTo&&clusterToAddTo.isMarkerInClusterBounds(marker)){clusterToAddTo.addMarker(marker)}else{var cluster=new Cluster(this);cluster.addMarker(marker);this.clusters_.push(cluster)}};MarkerClusterer.prototype.createClusters_=function(){if(!this.ready_){return}var mapBounds=new google.maps.LatLngBounds(this.map_.getBounds().getSouthWest(),this.map_.getBounds().getNorthEast());var bounds=this.getExtendedBounds(mapBounds);for(var i=0,marker;marker=this.markers_[i];i++){if(!marker.isAdded&&this.isMarkerInBounds_(marker,bounds)){this.addToClosestCluster_(marker)}}};function Cluster(markerClusterer){this.markerClusterer_=markerClusterer;this.map_=markerClusterer.getMap();this.gridSize_=markerClusterer.getGridSize();this.minClusterSize_=markerClusterer.getMinClusterSize();this.averageCenter_=markerClusterer.isAverageCenter();this.center_=null;this.markers_=[];this.bounds_=null;this.clusterIcon_=new ClusterIcon(this,markerClusterer.getStyles(),markerClusterer.getGridSize())}Cluster.prototype.isMarkerAlreadyAdded=function(marker){if(this.markers_.indexOf){return this.markers_.indexOf(marker)!=-1}else{for(var i=0,m;m=this.markers_[i];i++){if(m==marker){return true}}}return false};Cluster.prototype.addMarker=function(marker){if(this.isMarkerAlreadyAdded(marker)){return false}if(!this.center_){this.center_=marker.getPosition();this.calculateBounds_()}else{if(this.averageCenter_){var l=this.markers_.length+1;var lat=(this.center_.lat()*(l-1)+marker.getPosition().lat())/l;var lng=(this.center_.lng()*(l-1)+marker.getPosition().lng())/l;this.center_=new google.maps.LatLng(lat,lng);this.calculateBounds_()}}marker.isAdded=true;this.markers_.push(marker);var len=this.markers_.length;if(len<this.minClusterSize_&&marker.getMap()!=this.map_){marker.setMap(this.map_)}if(len==this.minClusterSize_){for(var i=0;i<len;i++){this.markers_[i].setMap(null)}}if(len>=this.minClusterSize_){marker.setMap(null)}this.updateIcon();return true};Cluster.prototype.getMarkerClusterer=function(){return this.markerClusterer_};Cluster.prototype.getBounds=function(){var bounds=new google.maps.LatLngBounds(this.center_,this.center_);var markers=this.getMarkers();for(var i=0,marker;marker=markers[i];i++){bounds.extend(marker.getPosition())}return bounds};Cluster.prototype.remove=function(){this.clusterIcon_.remove();this.markers_.length=0;delete this.markers_};Cluster.prototype.getSize=function(){return this.markers_.length};Cluster.prototype.getMarkers=function(){return this.markers_};Cluster.prototype.getCenter=function(){return this.center_};Cluster.prototype.calculateBounds_=function(){var bounds=new google.maps.LatLngBounds(this.center_,this.center_);this.bounds_=this.markerClusterer_.getExtendedBounds(bounds)};Cluster.prototype.isMarkerInClusterBounds=function(marker){return this.bounds_.contains(marker.getPosition())};Cluster.prototype.getMap=function(){return this.map_};Cluster.prototype.updateIcon=function(){var zoom=this.map_.getZoom();var mz=this.markerClusterer_.getMaxZoom();if(mz&&zoom>mz){for(var i=0,marker;marker=this.markers_[i];i++){marker.setMap(this.map_)}return}if(this.markers_.length<this.minClusterSize_){this.clusterIcon_.hide();return}var numStyles=this.markerClusterer_.getStyles().length;var sums=this.markerClusterer_.getCalculator()(this.markers_,numStyles);this.clusterIcon_.setCenter(this.center_);this.clusterIcon_.setSums(sums);this.clusterIcon_.show()};function ClusterIcon(cluster,styles,opt_padding){cluster.getMarkerClusterer().extend(ClusterIcon,google.maps.OverlayView);this.styles_=styles;this.padding_=opt_padding||0;this.cluster_=cluster;this.center_=null;this.map_=cluster.getMap();this.div_=null;this.sums_=null;this.visible_=false;this.setMap(this.map_)}ClusterIcon.prototype.triggerClusterClick=function(){var markerClusterer=this.cluster_.getMarkerClusterer();google.maps.event.trigger(markerClusterer,"clusterclick",this.cluster_);if(markerClusterer.isZoomOnClick()){this.map_.fitBounds(this.cluster_.getBounds())}};ClusterIcon.prototype.onAdd=function(){this.div_=document.createElement("DIV");if(this.visible_){var pos=this.getPosFromLatLng_(this.center_);this.div_.style.cssText=this.createCss(pos);this.div_.innerHTML=this.sums_.text}var panes=this.getPanes();panes.overlayMouseTarget.appendChild(this.div_);var that=this;google.maps.event.addDomListener(this.div_,"click",function(){that.triggerClusterClick()})};ClusterIcon.prototype.getPosFromLatLng_=function(latlng){var pos=this.getProjection().fromLatLngToDivPixel(latlng);pos.x-=parseInt(this.width_/2,10);pos.y-=parseInt(this.height_/2,10);return pos};ClusterIcon.prototype.draw=function(){if(this.visible_){var pos=this.getPosFromLatLng_(this.center_);this.div_.style.top=pos.y+"px";this.div_.style.left=pos.x+"px"}};ClusterIcon.prototype.hide=function(){if(this.div_){this.div_.style.display="none"}this.visible_=false};ClusterIcon.prototype.show=function(){if(this.div_){var pos=this.getPosFromLatLng_(this.center_);this.div_.style.cssText=this.createCss(pos);this.div_.style.display=""}this.visible_=true};ClusterIcon.prototype.remove=function(){this.setMap(null)};ClusterIcon.prototype.onRemove=function(){if(this.div_&&this.div_.parentNode){this.hide();this.div_.parentNode.removeChild(this.div_);this.div_=null}};ClusterIcon.prototype.setSums=function(sums){this.sums_=sums;this.text_=sums.text;this.index_=sums.index;if(this.div_){this.div_.innerHTML=sums.text}this.useStyle()};ClusterIcon.prototype.useStyle=function(){var index=Math.max(0,this.sums_.index-1);index=Math.min(this.styles_.length-1,index);var style=this.styles_[index];this.url_=style["url"];this.height_=style["height"];this.width_=style["width"];this.textColor_=style["textColor"];this.anchor_=style["anchor"];this.textSize_=style["textSize"];this.backgroundPosition_=style["backgroundPosition"]};ClusterIcon.prototype.setCenter=function(center){this.center_=center};ClusterIcon.prototype.createCss=function(pos){var style=[];style.push("background-image:url("+this.url_+");");var backgroundPosition=this.backgroundPosition_?this.backgroundPosition_:"0 0";style.push("background-position:"+backgroundPosition+";");if(typeof this.anchor_==="object"){if(typeof this.anchor_[0]==="number"&&this.anchor_[0]>0&&this.anchor_[0]<this.height_){style.push("height:"+(this.height_-this.anchor_[0])+"px; padding-top:"+this.anchor_[0]+"px;")}else{style.push("height:"+this.height_+"px; line-height:"+this.height_+"px;")}if(typeof this.anchor_[1]==="number"&&this.anchor_[1]>0&&this.anchor_[1]<this.width_){style.push("width:"+(this.width_-this.anchor_[1])+"px; padding-left:"+this.anchor_[1]+"px;")}else{style.push("width:"+this.width_+"px; text-align:center;")}}else{style.push("height:"+this.height_+"px; line-height:"+this.height_+"px; width:"+this.width_+"px; text-align:center;")}var txtColor=this.textColor_?this.textColor_:"black";var txtSize=this.textSize_?this.textSize_:11;style.push("cursor:pointer; top:"+pos.y+"px; left:"+pos.x+"px; color:"+txtColor+"; position:absolute; font-size:"+txtSize+"px; font-family:Arial,sans-serif; font-weight:bold");return style.join("")};window["MarkerClusterer"]=MarkerClusterer;MarkerClusterer.prototype["addMarker"]=MarkerClusterer.prototype.addMarker;MarkerClusterer.prototype["addMarkers"]=MarkerClusterer.prototype.addMarkers;MarkerClusterer.prototype["clearMarkers"]=MarkerClusterer.prototype.clearMarkers;MarkerClusterer.prototype["fitMapToMarkers"]=MarkerClusterer.prototype.fitMapToMarkers;MarkerClusterer.prototype["getCalculator"]=MarkerClusterer.prototype.getCalculator;MarkerClusterer.prototype["getGridSize"]=MarkerClusterer.prototype.getGridSize;MarkerClusterer.prototype["getExtendedBounds"]=MarkerClusterer.prototype.getExtendedBounds;MarkerClusterer.prototype["getMap"]=MarkerClusterer.prototype.getMap;MarkerClusterer.prototype["getMarkers"]=MarkerClusterer.prototype.getMarkers;MarkerClusterer.prototype["getMaxZoom"]=MarkerClusterer.prototype.getMaxZoom;MarkerClusterer.prototype["getStyles"]=MarkerClusterer.prototype.getStyles;MarkerClusterer.prototype["getTotalClusters"]=MarkerClusterer.prototype.getTotalClusters;MarkerClusterer.prototype["getTotalMarkers"]=MarkerClusterer.prototype.getTotalMarkers;MarkerClusterer.prototype["redraw"]=MarkerClusterer.prototype.redraw;MarkerClusterer.prototype["removeMarker"]=MarkerClusterer.prototype.removeMarker;MarkerClusterer.prototype["removeMarkers"]=MarkerClusterer.prototype.removeMarkers;MarkerClusterer.prototype["resetViewport"]=MarkerClusterer.prototype.resetViewport;MarkerClusterer.prototype["repaint"]=MarkerClusterer.prototype.repaint;MarkerClusterer.prototype["setCalculator"]=MarkerClusterer.prototype.setCalculator;MarkerClusterer.prototype["setGridSize"]=MarkerClusterer.prototype.setGridSize;MarkerClusterer.prototype["setMaxZoom"]=MarkerClusterer.prototype.setMaxZoom;MarkerClusterer.prototype["onAdd"]=MarkerClusterer.prototype.onAdd;MarkerClusterer.prototype["draw"]=MarkerClusterer.prototype.draw;Cluster.prototype["getCenter"]=Cluster.prototype.getCenter;Cluster.prototype["getSize"]=Cluster.prototype.getSize;Cluster.prototype["getMarkers"]=Cluster.prototype.getMarkers;ClusterIcon.prototype["onAdd"]=ClusterIcon.prototype.onAdd;ClusterIcon.prototype["draw"]=ClusterIcon.prototype.draw;ClusterIcon.prototype["onRemove"]=ClusterIcon.prototype.onRemove})(jQuery);

(function($,win){var loaded_scripts={},$win=$(window);win.$widgetkit={version:"1.4.9",lazyloaders:{},load:function(script){if(!loaded_scripts[script]){var url=script+"?wkv="+this.version;loaded_scripts[script]=$.ajax({dataType:"script",cache:true,url:url})}return loaded_scripts[script]},lazyload:function(context){context=context||document;$("[data-widgetkit]",context).each(function(){var ele=$(this),type=ele.data("widgetkit"),options=ele.data("options")||{};if(!ele.data("wk-loaded")&&$widgetkit.lazyloaders[type]){$widgetkit.lazyloaders[type](ele,options);ele.data("wk-loaded",true)}})}};$(function(){$widgetkit.lazyload()});$win.on("load",function(){$win.resize()});var div=document.createElement("div"),divStyle=div.style,transition=false,prefixes="-webkit- -moz- -o- -ms- -khtml-".split(" "),domPrefixes="Webkit Moz O ms Khtml".split(" "),prefix="";for(var i=0;i<domPrefixes.length;i++){if(divStyle[domPrefixes[i]+"Transition"]===""){transition=domPrefixes[i]+"Transition";prefix=prefixes[i];break}}$widgetkit.prefix=prefix;$widgetkit.support={transition:transition,css3d:transition&&("WebKitCSSMatrix"in window&&"m11"in new WebKitCSSMatrix&&!navigator.userAgent.match(/Chrome/i)),canvas:function(){var check,elem=document.createElement("canvas");check=!!(elem.getContext&&elem.getContext("2d"));elem=null;return check}()};$widgetkit.css3=function(cssprops){cssprops=cssprops||{};if(cssprops["transition"]){cssprops[prefix+"transition"]=cssprops["transition"]}if(cssprops["transform"]){cssprops[prefix+"transform"]=cssprops["transform"]}if(cssprops["transform-origin"]){cssprops[prefix+"transform-origin"]=cssprops["transform-origin"]}return cssprops};$.browser=$.browser||function(ua){ua=ua.toLowerCase();var browser={},match=/(chrome)[ \/]([\w.]+)/.exec(ua)||/(webkit)[ \/]([\w.]+)/.exec(ua)||/(opera)(?:.*version)?[ \/]([\w.]+)/.exec(ua)||/(msie) ([\w.]+)/.exec(ua)||ua.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+))?/.exec(ua)||[];if(match){browser[match[1]]=true;browser["version"]=match[2]||"0"}return browser}(navigator.userAgent);div=null})(jQuery,window);(function($){var ie=function(){try{return parseInt(navigator.appVersion.match(/MSIE (\d\.\d)/)[1],10)}catch(e){}return false}();if(ie&&ie<9){$(document).ready(function(){$("body").addClass("wk-ie wk-ie"+ie)});$.each(["abbr","article","aside","audio","canvas","details","figcaption","figure","footer","header","hgroup","mark","meter","nav","output","progress","section","summary","time","video"],function(){document.createElement(this)})}})(jQuery);(function($,win){win.$widgetkit.trans={__data:{},addDic:function(dic){$.extend(this.__data,dic)},add:function(key,data){this.__data[key]=data},get:function(key){if(!this.__data[key]){return key}var args=arguments.length==1?[]:Array.prototype.slice.call(arguments,1),ret=String(this.__data[key]);return this.printf(ret,args)},printf:function(S,L){if(!L)return S;var nS="",tS=S.split("%s");if(tS.length==1)return S;for(var i=0;i<L.length;i++){if(tS[i].lastIndexOf("%")==tS[i].length-1&&i!=L.length-1)tS[i]+="s"+tS.splice(i+1,1)[0];nS+=tS[i]+L[i]}return nS+tS[tS.length-1]}}})(jQuery,window);(function(jQuery){jQuery.easing["jswing"]=jQuery.easing["swing"];jQuery.extend(jQuery.easing,{def:"easeOutQuad",swing:function(x,t,b,c,d){return jQuery.easing[jQuery.easing.def](x,t,b,c,d)},easeInQuad:function(x,t,b,c,d){return c*(t/=d)*t+b},easeOutQuad:function(x,t,b,c,d){return-c*(t/=d)*(t-2)+b},easeInOutQuad:function(x,t,b,c,d){if((t/=d/2)<1)return c/2*t*t+b;return-c/2*(--t*(t-2)-1)+b},easeInCubic:function(x,t,b,c,d){return c*(t/=d)*t*t+b},easeOutCubic:function(x,t,b,c,d){return c*((t=t/d-1)*t*t+1)+b},easeInOutCubic:function(x,t,b,c,d){if((t/=d/2)<1)return c/2*t*t*t+b;return c/2*((t-=2)*t*t+2)+b},easeInQuart:function(x,t,b,c,d){return c*(t/=d)*t*t*t+b},easeOutQuart:function(x,t,b,c,d){return-c*((t=t/d-1)*t*t*t-1)+b},easeInOutQuart:function(x,t,b,c,d){if((t/=d/2)<1)return c/2*t*t*t*t+b;return-c/2*((t-=2)*t*t*t-2)+b},easeInQuint:function(x,t,b,c,d){return c*(t/=d)*t*t*t*t+b},easeOutQuint:function(x,t,b,c,d){return c*((t=t/d-1)*t*t*t*t+1)+b},easeInOutQuint:function(x,t,b,c,d){if((t/=d/2)<1)return c/2*t*t*t*t*t+b;return c/2*((t-=2)*t*t*t*t+2)+b},easeInSine:function(x,t,b,c,d){return-c*Math.cos(t/d*(Math.PI/2))+c+b},easeOutSine:function(x,t,b,c,d){return c*Math.sin(t/d*(Math.PI/2))+b},easeInOutSine:function(x,t,b,c,d){return-c/2*(Math.cos(Math.PI*t/d)-1)+b},easeInExpo:function(x,t,b,c,d){return t==0?b:c*Math.pow(2,10*(t/d-1))+b},easeOutExpo:function(x,t,b,c,d){return t==d?b+c:c*(-Math.pow(2,-10*t/d)+1)+b},easeInOutExpo:function(x,t,b,c,d){if(t==0)return b;if(t==d)return b+c;if((t/=d/2)<1)return c/2*Math.pow(2,10*(t-1))+b;return c/2*(-Math.pow(2,-10*--t)+2)+b},easeInCirc:function(x,t,b,c,d){return-c*(Math.sqrt(1-(t/=d)*t)-1)+b},easeOutCirc:function(x,t,b,c,d){return c*Math.sqrt(1-(t=t/d-1)*t)+b},easeInOutCirc:function(x,t,b,c,d){if((t/=d/2)<1)return-c/2*(Math.sqrt(1-t*t)-1)+b;return c/2*(Math.sqrt(1-(t-=2)*t)+1)+b},easeInElastic:function(x,t,b,c,d){var s=1.70158;var p=0;var a=c;if(t==0)return b;if((t/=d)==1)return b+c;if(!p)p=d*.3;if(a<Math.abs(c)){a=c;var s=p/4}else var s=p/(2*Math.PI)*Math.asin(c/a);return-(a*Math.pow(2,10*(t-=1))*Math.sin((t*d-s)*(2*Math.PI)/p))+b},easeOutElastic:function(x,t,b,c,d){var s=1.70158;var p=0;var a=c;if(t==0)return b;if((t/=d)==1)return b+c;if(!p)p=d*.3;if(a<Math.abs(c)){a=c;var s=p/4}else var s=p/(2*Math.PI)*Math.asin(c/a);return a*Math.pow(2,-10*t)*Math.sin((t*d-s)*(2*Math.PI)/p)+c+b},easeInOutElastic:function(x,t,b,c,d){var s=1.70158;var p=0;var a=c;if(t==0)return b;if((t/=d/2)==2)return b+c;if(!p)p=d*(.3*1.5);if(a<Math.abs(c)){a=c;var s=p/4}else var s=p/(2*Math.PI)*Math.asin(c/a);if(t<1)return-.5*(a*Math.pow(2,10*(t-=1))*Math.sin((t*d-s)*(2*Math.PI)/p))+b;return a*Math.pow(2,-10*(t-=1))*Math.sin((t*d-s)*(2*Math.PI)/p)*.5+c+b},easeInBack:function(x,t,b,c,d,s){if(s==undefined)s=1.70158;return c*(t/=d)*t*((s+1)*t-s)+b},easeOutBack:function(x,t,b,c,d,s){if(s==undefined)s=1.70158;return c*((t=t/d-1)*t*((s+1)*t+s)+1)+b},easeInOutBack:function(x,t,b,c,d,s){if(s==undefined)s=1.70158;if((t/=d/2)<1)return c/2*(t*t*(((s*=1.525)+1)*t-s))+b;return c/2*((t-=2)*t*(((s*=1.525)+1)*t+s)+2)+b},easeInBounce:function(x,t,b,c,d){return c-jQuery.easing.easeOutBounce(x,d-t,0,c,d)+b},easeOutBounce:function(x,t,b,c,d){if((t/=d)<1/2.75){return c*(7.5625*t*t)+b}else if(t<2/2.75){return c*(7.5625*(t-=1.5/2.75)*t+.75)+b}else if(t<2.5/2.75){return c*(7.5625*(t-=2.25/2.75)*t+.9375)+b}else{return c*(7.5625*(t-=2.625/2.75)*t+.984375)+b}},easeInOutBounce:function(x,t,b,c,d){if(t<d/2)return jQuery.easing.easeInBounce(x,t*2,0,c,d)*.5+b;return jQuery.easing.easeOutBounce(x,t*2-d,0,c,d)*.5+c*.5+b}})})(jQuery);(function(factory){if(typeof define==="function"&&define.amd){define("jquery.mousewheel",["jquery"],factory)}else if(typeof exports==="object"){module.exports=factory}else{factory(jQuery)}})(function($){var toFix=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"],toBind="onwheel"in document||document.documentMode>=9?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"],slice=Array.prototype.slice,nullLowestDeltaTimeout,lowestDelta;if($.event.fixHooks){for(var i=toFix.length;i;){$.event.fixHooks[toFix[--i]]=$.event.mouseHooks}}var special=$.event.special.mousewheel={version:"3.1.11",setup:function(){if(this.addEventListener){for(var i=toBind.length;i;){this.addEventListener(toBind[--i],handler,false)}}else{this.onmousewheel=handler}$.data(this,"mousewheel-line-height",special.getLineHeight(this));$.data(this,"mousewheel-page-height",special.getPageHeight(this))},teardown:function(){if(this.removeEventListener){for(var i=toBind.length;i;){this.removeEventListener(toBind[--i],handler,false)}}else{this.onmousewheel=null}$.removeData(this,"mousewheel-line-height");$.removeData(this,"mousewheel-page-height")},getLineHeight:function(elem){var $parent=$(elem)["offsetParent"in $.fn?"offsetParent":"parent"]();if(!$parent.length){$parent=$("body")}return parseInt($parent.css("fontSize"),10)},getPageHeight:function(elem){return $(elem).height()},settings:{adjustOldDeltas:true,normalizeOffset:true}};$.fn.extend({mousewheel:function(fn){return fn?this.bind("mousewheel",fn):this.trigger("mousewheel")},unmousewheel:function(fn){return this.unbind("mousewheel",fn)}});function handler(event){var orgEvent=event||window.event,args=slice.call(arguments,1),delta=0,deltaX=0,deltaY=0,absDelta=0,offsetX=0,offsetY=0;event=$.event.fix(orgEvent);event.type="mousewheel";if("detail"in orgEvent){deltaY=orgEvent.detail*-1}if("wheelDelta"in orgEvent){deltaY=orgEvent.wheelDelta}if("wheelDeltaY"in orgEvent){deltaY=orgEvent.wheelDeltaY}if("wheelDeltaX"in orgEvent){deltaX=orgEvent.wheelDeltaX*-1}if("axis"in orgEvent&&orgEvent.axis===orgEvent.HORIZONTAL_AXIS){deltaX=deltaY*-1;deltaY=0}delta=deltaY===0?deltaX:deltaY;if("deltaY"in orgEvent){deltaY=orgEvent.deltaY*-1;delta=deltaY}if("deltaX"in orgEvent){deltaX=orgEvent.deltaX;if(deltaY===0){delta=deltaX*-1}}if(deltaY===0&&deltaX===0){return}if(orgEvent.deltaMode===1){var lineHeight=$.data(this,"mousewheel-line-height");delta*=lineHeight;deltaY*=lineHeight;deltaX*=lineHeight}else if(orgEvent.deltaMode===2){var pageHeight=$.data(this,"mousewheel-page-height");delta*=pageHeight;deltaY*=pageHeight;deltaX*=pageHeight}absDelta=Math.max(Math.abs(deltaY),Math.abs(deltaX));if(!lowestDelta||absDelta<lowestDelta){lowestDelta=absDelta;if(shouldAdjustOldDeltas(orgEvent,absDelta)){lowestDelta/=40}}if(shouldAdjustOldDeltas(orgEvent,absDelta)){delta/=40;deltaX/=40;deltaY/=40}delta=Math[delta>=1?"floor":"ceil"](delta/lowestDelta);deltaX=Math[deltaX>=1?"floor":"ceil"](deltaX/lowestDelta);deltaY=Math[deltaY>=1?"floor":"ceil"](deltaY/lowestDelta);if(special.settings.normalizeOffset&&this.getBoundingClientRect){var boundingRect=this.getBoundingClientRect();offsetX=event.clientX-boundingRect.left;offsetY=event.clientY-boundingRect.top}event.deltaX=deltaX;event.deltaY=deltaY;event.deltaFactor=lowestDelta;event.offsetX=offsetX;event.offsetY=offsetY;event.deltaMode=0;args.unshift(event,delta,deltaX,deltaY);if(nullLowestDeltaTimeout){clearTimeout(nullLowestDeltaTimeout)}nullLowestDeltaTimeout=setTimeout(nullLowestDelta,200);return($.event.dispatch||$.event.handle).apply(this,args)}function nullLowestDelta(){lowestDelta=null}function shouldAdjustOldDeltas(orgEvent,absDelta){return special.settings.adjustOldDeltas&&orgEvent.type==="mousewheel"&&absDelta%120===0}});(function($){function supportAjaxUploadWithProgress(){return supportFileAPI()&&supportAjaxUploadProgressEvents()&&supportFormData();function supportFileAPI(){var fi=document.createElement("INPUT");fi.type="file";return"files"in fi}function supportAjaxUploadProgressEvents(){var xhr=new XMLHttpRequest;return!!(xhr&&"upload"in xhr&&"onprogress"in xhr.upload)}function supportFormData(){return!!window.FormData}}$.support.ajaxupload=supportAjaxUploadWithProgress();if($.support.ajaxupload){$.event.props.push("dataTransfer")}$.fn.uploadOnDrag=function(options){if(!$.support.ajaxupload){return this}return this.each(function(){var ele=$(this),settings=$.extend({action:"",single:false,method:"POST",params:{},loadstart:function(){},load:function(){},loadend:function(){},progress:function(){},complete:function(){},allcomplete:function(){},readystatechange:function(){}},options);ele.on("drop",function(e){e.stopPropagation();e.preventDefault();var files=e.dataTransfer.files;if(settings.single){var count=e.dataTransfer.files.length,uploaded=0,complete=settings.complete;settings.complete=function(response,xhr){uploaded=uploaded+1;complete(response,xhr);if(uploaded<count){upload([files[uploaded]],settings)}else{settings.allcomplete()}};upload([files[0]],settings)}else{upload(files,settings)}function upload(files,settings){var formData=new FormData,xhr=new XMLHttpRequest;for(var i=0,f;f=files[i];i++){formData.append("files[]",f)}for(var p in settings.params){formData.append(p,settings.params[p])}xhr.upload.addEventListener("progress",function(e){var percent=e.loaded/e.total*100;settings.progress(percent,e)},false);xhr.addEventListener("loadstart",function(e){settings.loadstart(e)},false);xhr.addEventListener("load",function(e){settings.load(e)},false);xhr.addEventListener("loadend",function(e){settings.loadend(e)},false);xhr.addEventListener("error",function(e){settings.error(e)},false);xhr.addEventListener("abort",function(e){settings.abort(e)},false);xhr.open(settings.method,settings.action,true);xhr.onreadystatechange=function(){settings.readystatechange(xhr);if(xhr.readyState==4){var response=xhr.responseText;if(settings.type=="json"){try{response=$.parseJSON(response)}catch(e){response=false}}settings.complete(response,xhr)}};xhr.send(formData)}}).on("dragover",function(e){e.stopPropagation();e.preventDefault()})})};$.fn.ajaxform=function(options){if(!$.support.ajaxupload){return this}return this.each(function(){var form=$(this),settings=$.extend({action:form.attr("action"),method:form.attr("method"),loadstart:function(){},load:function(){},loadend:function(){},progress:function(){},complete:function(){},readystatechange:function(){}},options);form.on("submit",function(e){e.preventDefault();var formData=new FormData(this),xhr=new XMLHttpRequest;formData.append("formdata","1");xhr.upload.addEventListener("progress",function(e){var percent=e.loaded/e.total*100;settings.progress(percent,e)},false);xhr.addEventListener("loadstart",function(e){settings.loadstart(e)},false);xhr.addEventListener("load",function(e){settings.load(e)},false);xhr.addEventListener("loadend",function(e){settings.loadend(e)},false);xhr.addEventListener("error",function(e){settings.error(e)},false);xhr.addEventListener("abort",function(e){settings.abort(e)},false);xhr.open(settings.method,settings.action,true);xhr.onreadystatechange=function(){settings.readystatechange(xhr);if(xhr.readyState==4){var response=xhr.responseText;if(settings.type=="json"){try{response=$.parseJSON(response)}catch(e){response=false}}settings.complete(response,xhr)}};xhr.send(formData)})})};if(!$.event.special.debouncedresize){var $event=$.event,$special,resizeTimeout;$special=$event.special.debouncedresize={setup:function(){$(this).on("resize",$special.handler)},teardown:function(){$(this).off("resize",$special.handler)},handler:function(event,execAsap){var context=this,args=arguments,dispatch=function(){event.type="debouncedresize";$event.dispatch.apply(context,args)};if(resizeTimeout){clearTimeout(resizeTimeout)}execAsap?dispatch():resizeTimeout=setTimeout(dispatch,$special.threshold)},threshold:150}}})(jQuery);
(function(nav,win,doc){if(win.matchMedia&&!nav.userAgent.match(/(iPhone|iPod|iPad)/i)){return}var bool,docElem=doc.documentElement,refNode=docElem.firstElementChild||docElem.firstChild,fakeBody=doc.createElement("body"),div=doc.createElement("div");div.id="mq-test-1";div.style.cssText="position:absolute;top:-100em";fakeBody.style.background="none";fakeBody.appendChild(div);function check(q){div.innerHTML='&shy;<style media="'+q+'"> #mq-test-1 { width: 42px; }</style>';docElem.insertBefore(fakeBody,refNode);bool=div.offsetWidth==42;docElem.removeChild(fakeBody);return bool}function update(query){var matches=check(query.media);if(query._listeners&&query.matches!=matches){query.matches=matches;for(var i=0,len=query._listeners.length;i<len;i++){query._listeners[i](query)}}}function debounce(func,wait,immediate){var timeout;return function(){var context=this,args=arguments;var later=function(){timeout=null;if(!immediate)func.apply(context,args)};var callNow=immediate&&!timeout;clearTimeout(timeout);timeout=setTimeout(later,wait);if(callNow)func.apply(context,args)}}win.matchMedia=function(q){var query,ls=[];query={matches:check(q),media:q,_listeners:ls,addListener:function(listener){if(typeof listener==="function")ls.push(listener)},removeListener:function(listener){for(var i=0,len=ls.length;i<len;i++)if(ls[i]===listener)delete ls[i]}};if(win.addEventListener){win.addEventListener("resize",debounce(function(){update(query)},150),false)}if(doc.addEventListener){doc.addEventListener("orientationchange",function(){update(query)},false)}return query}})(navigator,window,document);(function($,win,doc){if($["onMediaQuery"])return;var queries={},supported=win.matchMedia&&win.matchMedia("only all").matches;$(doc).ready(function(){for(var q in queries){var query=$(queries[q]).trigger("init");if(queries[q].matches){$(queries[q]).trigger("valid")}}});$(win).bind("load",function(){for(var q in queries){if(queries[q].matches){$(queries[q]).trigger("valid")}}});$.onMediaQuery=function(q,events){var query=q&&queries[q];if(!query){query=queries[q]=win.matchMedia(q);query.supported=supported;query.addListener(function(){$(query).trigger(query.matches?"valid":"invalid")})}$(query).bind(events);return query}})(jQuery,window,document);
jQuery(function($){$("#tabs").tabs().prev().append('<li class="version">'+$("#tabs").data("wkversion")+"</li>");$("#widgetkit").delegate(".box .deletable","click",function(e){$(this).parent().trigger("delete",[$(this)])});$("input:text").placeholder()});jQuery("body").bind("afterPreWpautop",function(e,o){o.data=o.unfiltered.replace(/caption\]\[caption/g,"caption] [caption").replace(/<object[\s\S]+?<\/object>/g,function(a){return a.replace(/[\r\n]+/g," ")})}).bind("afterWpautop",function(e,o){o.data=o.unfiltered});(function($){var storage={get:function(key){return window["sessionStorage"]?sessionStorage.getItem(key):null},set:function(key,data){if(window["sessionStorage"])sessionStorage.setItem(key,data)}};$.fn["tabs"]=function(){return this.each(function(){var content=$(this).addClass("content").wrap('<div class="tabs-box" />').before('<ul class="nav" />');var navigation=$(this).prev("ul.nav");content.children("li").each(function(){navigation.append("<li><a>"+$(this).hide().attr("data-name")+"</a></li>")});navigation.children("li").bind("click",function(e){e.preventDefault();var index=$("li",navigation).removeClass("active").index($(this).addClass("active").get(0));var tabs=content.children("li").hide();$(tabs[index]).show();storage.set("widgetkit-tab",index)});var current=parseInt(storage.get("widgetkit-tab"));$(!isNaN(current)?navigation.children("li").get(current):navigation.children("li:first")).trigger("click")})}})(jQuery);(function($){var Plugin=function(){};$.extend(Plugin.prototype,{name:"finder",initialize:function(element,options){var $this=this;this.options=$.extend({url:"",path:"",open:"open",loading:"loading"},options);element.data("path",this.options.path).bind("retrieve:finder",retrieve).trigger("retrieve:finder");function retrieve(e){e.preventDefault();var item=$(this).closest("li",element);if(!item.length){item=element}if(item.hasClass($this.options.open)){item.removeClass($this.options.open).children("ul").slideUp()}else{item.addClass($this.options.loading);$.post($this.options.url,{path:item.data("path")},function(data){item.removeClass($this.options.loading).addClass($this.options.open);if(!data.length)return;item.children().remove("ul");item.append("<ul>").children("ul").hide();$.each(data,function(i,val){item.children("ul").append($('<li><a href="#">'+val.name+"</a></li>").addClass(val.type).data("path",val.path))});item.find("ul a").bind("click",retrieve);item.children("ul").slideDown()},"json")}}}});$.fn[Plugin.prototype.name]=function(){var args=arguments;var method=args[0]?args[0]:null;return this.each(function(){var element=$(this);if(Plugin.prototype[method]&&element.data(Plugin.prototype.name)&&method!="initialize"){element.data(Plugin.prototype.name)[method].apply(element.data(Plugin.prototype.name),Array.prototype.slice.call(args,1))}else if(!method||$.isPlainObject(method)){var plugin=new Plugin;if(Plugin.prototype["initialize"]){plugin.initialize.apply(plugin,$.merge([element],args))}element.data(Plugin.prototype.name,plugin)}else{$.error("Method "+method+" does not exist on jQuery."+Plugin.name)}})}})(jQuery);(function($){var isInputSupported="placeholder"in document.createElement("input"),isTextareaSupported="placeholder"in document.createElement("textarea");if(isInputSupported&&isTextareaSupported){$.fn.placeholder=function(){return this}}else{$.fn.placeholder=function(){return this.filter((isInputSupported?"textarea":":input")+"[placeholder]").bind("focus.placeholder",clearPlaceholder).bind("blur.placeholder",setPlaceholder).trigger("blur.placeholder").end()}}function args(elem){var newAttrs={},rinlinejQuery=/^jQuery\d+$/;$.each(elem.attributes,function(i,attr){if(attr.specified&&!rinlinejQuery.test(attr.name)){newAttrs[attr.name]=attr.value}});return newAttrs}function clearPlaceholder(){var $input=$(this);if($input.val()===$input.attr("placeholder")&&$input.hasClass("placeholder")){if($input.data("placeholder-password")){$input.hide().next().show().focus()}else{$input.val("").removeClass("placeholder")}}}function setPlaceholder(elem){var $replacement,$input=$(this);if($input.val()===""||$input.val()===$input.attr("placeholder")){if($input.is(":password")){if(!$input.data("placeholder-textinput")){try{$replacement=$input.clone().attr({type:"text"})}catch(e){$replacement=$("<input>").attr($.extend(args($input[0]),{type:"text"}))}$replacement.removeAttr("name").data("placeholder-password",true).bind("focus.placeholder",clearPlaceholder);$input.data("placeholder-textinput",$replacement).before($replacement)}$input=$input.hide().prev().show()}$input.addClass("placeholder").val($input.attr("placeholder"))}else{$input.removeClass("placeholder")}}$(function(){$("form").bind("submit.placeholder",function(){var $inputs=$(".placeholder",this).each(clearPlaceholder);setTimeout(function(){$inputs.each(setPlaceholder)},10)})});$(window).bind("unload.placeholder",function(){$(".placeholder").val("")})})(jQuery);(function($){var $win=$(window),$doc=$(document),visible=false,persist=false,modal=null,overlay=null;$.modalwin=function(content,settings){var settings=settings||{};if(visible){$.modalwin.close()}if(typeof content==="object"){content=$(content);if(content.parent().length){this.persist=content;this.persist.data("modal-persist-parent",content.parent())}}else if(typeof content==="string"||typeof content==="number"){content=$("<div></div>").html(content)}else{content=$("<div></div>").html("Modalwin Error: Unsupported data type: "+typeof content)}modal=$('<div class="modalwin"><div class="inner"></div><div class="btnclose"></div>');modal.find(".inner:first").append(content);modal.css({position:"fixed","z-index":101}).find(".btnclose").click($.modalwin.close);overlay=$('<div class="modal-overlay"></div>').css({position:"absolute",left:0,top:0,width:$doc.width(),height:$doc.height(),"z-index":100}).bind("click",$.modalwin.close);$("body").append(overlay).append(modal.hide());modal.show().css({left:$win.width()/2-modal.width()/2,top:$win.height()/2-modal.height()/2}).fadeIn();visible=true};$.modalwin.close=function(){if(!visible)return;if(persist){persist.appendTo(this.persist.data("modal-persist-parent"));persist=false}modal.remove();overlay.remove();modal=null;overlay=null;visible=false};$win.bind("resize",function(){if(visible){modal.css({left:$win.width()/2-modal.width()/2,top:$win.height()/2-modal.height()/2});overlay.css({width:$doc.width(),height:$doc.height()})}})})(jQuery);
var widgetkitajax="http://localhost/eat-theme-wp/wp-admin/admin-ajax.php?action=widgetkit&ajax=1";